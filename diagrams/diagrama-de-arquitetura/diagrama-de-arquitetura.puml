@startuml
skinparam rectangle<<behavior>> {
    roundCorner 25
}
sprite $bProcess jar:archimate/business-process
sprite $aService jar:archimate/application-service
sprite $aComponent jar:archimate/application-component
sprite $tNode jar:archimate/technology-node
sprite $tDevice jar:archimate/device

' --- CAMADA DE NEGÓCIO (Requisitos do Lab 02) ---
rectangle "Processo de\nGestão de Aluguel" as GA <<$bProcess>><<behavior>> #Business
rectangle "Realizar Cadastro" as RC <<$bProcess>><<behavior>> #Business
rectangle "Solicitar e Modificar\nPedidos" as SMP <<$bProcess>><<behavior>> #Business
rectangle "Avaliação Financeira\n(Agentes)" as AF <<$bProcess>><<behavior>> #Business

GA *-down- RC
GA *-down- SMP
GA *-down- AF

' --- CAMADA DE APLICAÇÃO (Componentes de Software) ---
rectangle "Frontend SPA\n(React.js)" as ReactApp <<$aComponent>> #Application
rectangle "Backend API\n(Spring Boot)" as SpringApp <<$aComponent>> #Application

' Interfaces Expostas
rectangle "Interface Web\n(Cliente/Agente)" as WebUI <<$aService>><<behavior>> #Application
rectangle "REST API" as ApiService <<$aService>><<behavior>> #Application

ReactApp -up-> WebUI
SpringApp -up-> ApiService

WebUI .up.> RC : Permite
WebUI .up.> SMP : Permite
WebUI .up.> AF : Permite (Agentes)

' --- CAMADA DE TECNOLOGIA (AWS Cloud Infrastructure) ---

node "Cliente" as ClientNode <<$tDevice>> #Technology {
    rectangle "Navegador Web" as Browser <<$tNode>> #Technology
}

node "AWS Cloud" as AWS <<$tNode>> #Technology {
    
    rectangle "Amazon API Gateway\n(Load Balancer/Entry)" as APIGw <<$tNode>> #Technology
    
    rectangle "Container Service\n(ECS/EC2)" as Compute <<$tNode>> #Technology {
       rectangle "Spring Boot Instance" as SpringInstance <<$tNode>> #Technology
    }

    rectangle "Data Persistence" as DataLayer <<$tNode>> #Technology {
        rectangle "Amazon RDS\n(PostgreSQL)" as Postgres <<$tNode>> #Technology
        rectangle "Amazon ElastiCache\n(Redis)" as Redis <<$tNode>> #Technology
        rectangle "Amazon S3\n(Object Storage)" as S3 <<$tNode>> #Technology
    }
}

' Relacionamentos de Fluxo
Browser .right.> APIGw : HTTPS / JSON
APIGw .right.> SpringInstance : Roteamento
SpringInstance .right.> Postgres : Persistência (JPA)
SpringInstance .down.> Redis : Cache / Sessão
SpringInstance .down.> S3 : Documentos/Imagens

' Mapeamento Aplicação -> Infraestrutura
Browser -up- ReactApp : Executa
SpringInstance -up- SpringApp : Hospeda

legend left
Legenda dos Componentes:
====
<$bProcess> : Regras de Negócio
====
<$aComponent> : Módulos de Software (React/Spring)
====
<$tNode> : Serviços AWS (Infraestrutura)
endlegend
@enduml